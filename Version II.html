<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dark Ash Quiz Game</title>
<style>
body {
  font-family: Arial, sans-serif;
  background-color: #000;
  color: #fff;
  padding: 20px;
}

.container {
  max-width: 100%;
  margin: 0 auto;
  text-align: center;
}

h1 {
  color: #fff;
}

label {
  font-size: 18px;
  margin-bottom: 10px;
  display: block;
}

input[type="text"] {
  width: 80%;
  padding: 8px;
  margin-bottom: 10px;
}

button {
  padding: 14px 28px;
  background-color: #007bff;
  color: #fff;
  border: none;
  cursor: pointer;
  font-size: 16px;
  margin-top: 10px;
}

button:hover {
  background-color: #0056b3;
}

#question {
  margin-top: 20px;
  text-align: left;
}

#feedback {
  margin-top: 20px;
  font-weight: bold;
}

#score {
  margin-top: 20px;
  font-size: 24px;
}
</style>
</head>
<body>
<div class="container">
  <h1>Dark Ash Quiz Game</h1>
  <div id="start">
    <button onclick="startQuiz()">Start Quiz</button>
  </div>
  <div id="quiz" style="display:none;">
    <div id="currentQuestion"></div>
    <button onclick="editQuestion()">Edit Question</button>
    <label for="answer">Enter your answer:</label>
    <input type="text" id="answer">
    <button onclick="checkAnswer()">Submit Answer</button>
    <div id="feedback"></div>
    <button onclick="resetQuiz()">Reset Quiz</button>
    <button onclick="resetScore()">Reset Score</button>
    <button onclick="reAnswerQuestions()">Re-answer & Re-play</button>
    <button onclick="showScore()">Show Score</button>
    <div id="score" style="display:none;"></div>
  </div>
</div>
<script>
var currentQuestionIndex = 0;
var definitions = [];
var answers = [];
var score = 0;

function startQuiz() {
  document.getElementById('start').style.display = 'none';
  document.getElementById('quiz').style.display = 'block';
  generateQuestions();
}

function generateQuestions() {
  var savedDefinitions = localStorage.getItem('definitions');
  var savedAnswers = localStorage.getItem('answers');
  
  if (savedDefinitions && savedAnswers) {
    definitions = JSON.parse(savedDefinitions);
    answers = JSON.parse(savedAnswers);
    showNextQuestion();
  } else {
    var numQuestions = parseInt(prompt('Enter the number of definitions you want to be questioned on:'));
    for (var i = 0; i < numQuestions; i++) {
      var definition = prompt('Enter definition ' + (i + 1) + ':');
      var answer = prompt('Enter the answer for definition ' + (i + 1) + ':');
      definitions.push(definition);
      answers.push(answer);
    }
    localStorage.setItem('definitions', JSON.stringify(definitions));
    localStorage.setItem('answers', JSON.stringify(answers));
    showNextQuestion();
  }
}

function showNextQuestion() {
  var question = generateQuestionFromDefinition(definitions[currentQuestionIndex]);
  document.getElementById('currentQuestion').innerHTML = question;
}

function generateQuestionFromDefinition(definition) {
  var words = definition.trim().split(/\s+/);
  words.sort(function() { return 0.5 - Math.random() });
  var truncatedWords = words.slice(0, 14);
  var question = truncatedWords.join(' ');
  if (!question.startsWith("What")) {
    question = "What " + question;
  }
  question += " ?";
  
  var options = [answers[currentQuestionIndex]];
  while (options.length < 4) {
    var randomWord = words[Math.floor(Math.random() * words.length)];
    if (!options.includes(randomWord)) {
      options.push(randomWord);
    }
  }
  options.sort(function() { return 0.5 - Math.random() });
  
  var questionWithChoices = question + "<br>";
  for (var i = 0; i < options.length; i++) {
    questionWithChoices += "<br>" + String.fromCharCode(65 + i) + ". " + options[i];
  }
  
  return questionWithChoices;
}

function editQuestion() {
  var newQuestion = prompt('Edit the question:', definitions[currentQuestionIndex]);
  if (newQuestion !== null && newQuestion.trim() !== '') {
    definitions[currentQuestionIndex] = newQuestion.trim();
    showNextQuestion();
  }
}

function checkAnswer() {
  var userAnswer = document.getElementById('answer').value.trim();
  var correctAnswer = answers[currentQuestionIndex];
  var feedback = '';
  if (userAnswer.toLowerCase() === correctAnswer.toLowerCase()) {
    feedback = 'Correct!';
    score += 1;
  } else {
    feedback = 'Incorrect. The correct answer is: ' + correctAnswer;
    score -= 2;
    if (score < 0) score = 0;
  }
  document.getElementById('feedback').textContent = feedback;
  localStorage.setItem('score', score);
  
  currentQuestionIndex++;
  if (currentQuestionIndex < definitions.length) {
    setTimeout(showNextQuestion, 3000);
  } else {
    setTimeout(function() {
      alert('You have completed the quiz!');
    }, 4000);
  }
}

function resetQuiz() {
  localStorage.removeItem('definitions');
  localStorage.removeItem('answers');
  localStorage.removeItem('score');
  currentQuestionIndex = 0;
  definitions = [];
  answers = [];
  score = 0;
  startQuiz();
}

function resetScore() {
  localStorage.removeItem('score');
  score = 0;
  document.getElementById('score').textContent = 'Your score is: ' + score;
}

function reAnswerQuestions() {
  currentQuestionIndex = 0;
  showNextQuestion();
}

function showScore() {
  var savedScore = localStorage.getItem('score');
  if (savedScore) {
    score = parseInt(savedScore);
  }
  document.getElementById('score').style.display = 'block';
  document.getElementById('score').textContent = 'Your score is: ' + score;
}
</script>
</body>
</html>
